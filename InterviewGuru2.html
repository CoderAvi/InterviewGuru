<!DOCTYPE html>
<head>

<title> The Interview Guru </title>
<meta charset="utf-8">

<style>

circle {
  fill: rgb(31, 119, 180);
  fill-opacity: .25;
  stroke: rgb(31, 119, 180);
  stroke-width: 1px;
}

.leaf circle {
  fill: #ff7f0e;
  fill-opacity: 1;
}

text {
  font: 10px sans-serif;
}

input[name="inputbox"] {
  width: 425px;
}


input[name="inputbox2"] {
  width: 425px;
}

input[name="button"] {
  width: 100px;
}

input[name="button2"] {
  width: 100px;
}


</style>



<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="raphael-min.js"></script>
<script>
function showDistribution() {

d3.select("svg")
       .remove();
d3.select("#data").remove();
d3.select("body").append("div").attr("id","data").attr("align","center");

var diameter = 900,
    format = d3.format(",d");

var company = document.getElementById('company').value;

d3.json("cluster3c.json", function(error, root) {
  	if (error) return alert(error);
	
	var svg = d3.select("chart").append("svg")
		  .attr("width", diameter)
		  .attr("height", diameter/1.5)
		  .append("g")
	    	  .attr("transform", "translate(0,25)");

//	alert("inside cluster3c load");
	var node = svg.selectAll(".node") //its implicitly understood that the one that follows t tag also brings to t
	      	.data([{"r":100,"x":100,"y":100,"c":"Microsoft","t":"Algos"},{"r":50,"x":180,"y":100,"c":"Amazon","t":""},
		{"r":100,"x":400,"y":100,"c":"Microsoft","t":"Hash Tables"},{"r":50,"x":480,"y":100,"c":"Amazon","t":""},
		{"r":100,"x":100,"y":400,"c":"Microsoft","t":"Strings"},{"r":50,"x":180,"y":400,"c":"Amazon","t":""}])
	    	.enter().append("g")
	      	.attr("class", function(d) { return "node"; })
	      	.attr("transform", function(d) { return "translate(" + d["x"] + "," + d["y"] + ")"; });

  	node.append("title")
      	.text(function(d) { return d["c"]; });

  	node.append("circle")
      	.attr("r", function(d) { return d["r"]; });

  	node.append("text")
      	.attr("dy", ".3em")
      	.style("text-anchor", "middle")
      	.text(function(d) { return d["c"]; });

	node.append("text")
	//.attr("x",function(d) {return d["x"]-d["r"]-10;})
	//.attr("y",function(d) {return d["y"]-d["r"]-10;})
      	.attr("dy", function(d) {return (-1)*(parseInt(d["r"])+5);})
	.text(function(d) {return d["t"];});




});

var f = document.createElement("form");
var i = document.createElement("input");
f.innerHTML = f.innerHTML + 'Select a tag below and then click submit to see clusters of questions <BR>';
i.setAttribute('type',"text");
i.setAttribute('name',"inputbox2");
i.setAttribute('id',"qtag");
i.setAttribute('placeholder',"E.g: Algorithms");
var b = document.createElement("input");
b.setAttribute('type',"button");
b.setAttribute('name',"button2");
b.setAttribute('value',"Submit");
b.setAttribute('onClick',"showQuestions()");
f.appendChild(i);
f.appendChild(b);
var p= document.createElement("p");
p.appendChild(f);
document.getElementById("data").appendChild(p);

}

function showQuestions() {

d3.json("questions2.json", function(error, root) {
  	if (error) return alert(error);
	var company = document.getElementById('company').value;
	var qtag = document.getElementById('qtag').value;

  	//c_dict=root[company];
	//c_list=c_dict[qtag];
	c_list=[["qn58169.txt::: Question Details", "qn14467101.txt::: Question Details"], ["qn3771428.txt::: Question Details", "qn68908.txt::: Question Details", "qn3817943.txt::: Question Details", "qn3805408.txt::: Question Details", "qn3765414.txt::: Question Details"]];
	//var q_list=new Array();
	var k=0;
	//form questions in single cluster now.
	for (i in c_list) { 
		cluster=c_list[i];
		for (j in cluster) {
			//q_list[k]=cluster[j];	
			//k=k+1;
			var parts=cluster[j].split(":::");
			var len=parts[0].length;
			var qid=parts[0].substr(2,len-6);
			var qtext=parts[1];
			var a = document.createElement('a');
			var linkText = document.createTextNode(qtext);
			a.appendChild(linkText);
			a.title = qid;
			a.href = "http://www.careercup.com/question?id="+qid;
			var p= document.createElement("p");
			p.setAttribute('align','left');
			p.appendChild(a);
			document.getElementById("data").appendChild(p);
			//document.body.appendChild(a);
		}
		//q_list[k]="..";
		//k=k+1;
	}
	/*
 	d3.select("#data").selectAll("div")
    	.data(q_list)
  	.enter().append("p")
    	.text(function(d) { return d; });});*/
});
}


</script>

</head>
<body>
<div align="center">
<h2>
Welcome to Interview Guru!!
</h2>
</div>
<div align="center">
<form name="myform">
	Enter a company name in the box and click Submit to see the distribution and some sample questions: <BR>
	<p><input type="text" id="company" name="inputbox" placeholder="E.g: Microsoft">
	   <input type="button" name="button" value="Submit" onClick="showDistribution()"></p>
</form>
</div>
<div align="center">
<chart></chart>
</div>
<div align="center">
<qsel>
</qsel>
</div>

<div id="data" align="center">
<!--Questions go here.-->
</div>
</body>
</html>
